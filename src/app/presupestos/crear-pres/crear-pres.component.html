<div class="barra-fija">
  <div title="Clientes" routerLink="/listado-clientes">
    <i class="fas fa-address-book"></i>
  </div>
  <div title="Presupuestos" routerLink="/listado-presupuestos">
    <i class="fas fa-money-bill-alt"></i>
  </div>
</div>

<div class="col-md-12">
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a routerLink="/inicio">Inicio</a></li>
      <li class="breadcrumb-item"><a routerLink="/ventas">Ventas</a></li>
      <li class="breadcrumb-item"><a routerLink="/listado-presupuestos">Presupuestos</a></li>
      <li class="breadcrumb-item active" aria-current="page">Añadir Presupuesto</li>
    </ol>
  </nav>
</div>

<div class="col-md-12 titulo">
  <span>Añadir Presupuesto</span>
  <button class="btn btn-primary" routerLink="/listado-presupuestos">
    <strong>Volver</strong>
  </button>
</div>
<div class="col-md-10 offset-md-1 col-12">
  <div class="formulario">
    <form [formGroup]="presupuestoForm" (ngSubmit)="initItem()">
      <div class="form-group">
        <label for="cliente">Cliente</label>
        <input type="text" class="form-control" formControlName="cliente" list="clientes">
        <datalist id="clientes">
          <option *ngFor="let cliente of clientes" [value]="cliente.nombre">
            {{cliente.nombre}}
          </option>
        </datalist>
      </div>
      <div class="form-group">
        <label for="fecha">Fecha</label>
        <input type="date" class="form-control" formControlName="fecha">
      </div>
      <div class="form-group">
        <h5>Artículos</h5>
      </div>
      <hr>
      <!-- un div para introducir la generación de pequeños formularios del ts -->
      <div formArrayName="items"> 
        <!-- div para que se generen los formularios de la siguiente manera -->
        <div *ngFor="let item of presupuestoForm.controls.items.controls;let i=index">
        <!-- div con cada una de las filas que se vayan generando -->
          <div [formGroupName]="i" class="form-row">
            <div class="form-group col-md-1">
              <label>Nº</label>
              <input type="text" class="form-control" value="{{i+1}}" disabled>
            </div>
            <div class="form-group col-md-4">
              <label for="articulo">Artículo</label>
              <input type="text" class="form-control" forControlName="articulo">
            </div>
            <div class="form-group col-md-2">
              <label for="cantidad">Cantidad</label>
              <input type="number" class="form-control" forControlName="cantidad">
            </div>
            <div class="form-group col-md-2">
              <label for="precio">Precio</label>
              <input type="number" class="form-control" forControlName="precio">
            </div>
            <div class="form-group col-md-2">
              <label for="importe">Importe</label>
              <input type="number" class="form-control" forControlName="importe" [(ngModel)]="presupuestoForm.value.items[i].importe">
            </div>
            <div class="form-group col-md-1">
              <button class="btn btn-danger" style="margin-top:31.5px" (click)="removeItem(i)">
                <i class="fas fa-minus-circle"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
      <div class="form-row">
        <div class="col-md-1">
          <button class="btn btn-primary" (click)="addItem()">
            <i class="fas fa-plus-circle"></i>
          </button>
        </div>
        <div class="col-md-6"></div>
        <div class="col-md-2" style="text-align:right;margin-top:5px">
          <label for="suma">Suma</label>
        </div>
        <div class="col-md-2">
          <input type="number" class="form-control" formControlName="suma" [(ngModel)]="presupuestoForm.value.suma" readonly>
        </div>
        </div>
    </form>
    <pre>{{presupuestoForm.value | json}}</pre>
  </div>
</div>
